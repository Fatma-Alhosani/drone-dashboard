<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drone Surveillance Dashboard</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
:root {
  --bg: #111; --card: #1e1e1e; --text: #ddd; --accent: #4caf50; --danger: #d33; --border: #333;
}
body {
  background: var(--bg);
  color: var(--text);
  font-family: Arial, sans-serif;
  margin: 0; padding: 0;
}
header {
  background: var(--card);
  color: var(--accent);
  padding: 12px 20px;
  font-weight: bold;
  font-size: 16px;
  border-bottom: 2px solid var(--border);
}
main {
  display: flex;
  gap: 16px;
  padding: 20px;
}
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 8px;
  flex: 1;
  display: flex;
  flex-direction: column;
}
.card h3 {
  background: var(--bg);
  padding: 8px;
  margin: 0;
  border-bottom: 1px solid var(--border);
  color: var(--accent);
  font-size: 14px;
}
.card img {
  max-width: 100%;
  height: auto;
  border-radius: 0 0 8px 8px;
  object-fit: contain;
}
.controls {
  text-align: center;
  padding: 10px;
}
button {
  padding: 6px 10px;
  margin: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
button:hover { opacity: 0.9; }
#prev, #next, #refresh {
  background: var(--accent);
  color: white;
}
#discard {
  background: var(--danger);
  color: white;
}
#map { height: 300px; }
.counter {
  text-align: center;
  padding: 6px;
  font-size: 14px;
}
</style>
</head>
<body>
<header>üõ∞Ô∏è DRONE SURVEILLANCE DASHBOARD</header>
<main>
  <div class="card" id="imageCard">
    <h3>Images</h3>
    <img id="photo" src="" alt="No Image"/>
    <div class="counter" id="counter">0 of 0</div>
    <div class="controls">
      <button id="prev">Previous</button>
      <button id="refresh">Refresh</button>
      <button id="next">Next</button>
      <button id="discard">Discard</button>
    </div>
  </div>
  <div class="card">
    <h3>GPS Coordinates</h3>
    <div id="map"></div>
    <div class="counter" id="gpsInfo"></div>
  </div>
</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const photoEl = document.getElementById("photo");
const counterEl = document.getElementById("counter");
const gpsInfoEl = document.getElementById("gpsInfo");

let photos = [];
let gpsData = [];
let index = 0;
let discarded = JSON.parse(localStorage.getItem("discarded") || "[]");

async function loadData() {
  try {
    const [p, g] = await Promise.all([
      fetch("photos.json").then(r => r.json()),
      fetch("gps.json").then(r => r.json())
    ]);
    photos = p.filter(x => !discarded.includes(x.name));
    gpsData = g.filter(x => !discarded.includes(x.name.replace(".jpg", ".txt")));
    index = 0;
    showItem();
  } catch (e) {
    console.error(e);
  }
}

function showItem() {
  if (photos.length === 0) {
    photoEl.src = "";
    photoEl.alt = "No Images Available";
    counterEl.textContent = "0 of 0";
    gpsInfoEl.textContent = "";
    return;
  }
  const item = photos[index];
  photoEl.src = item.url;
  counterEl.textContent = `${index + 1} of ${photos.length}`;
  const gps = gpsData.find(x => x.name.replace(".txt", "") === item.name.replace(".jpg", ""));
  if (gps) {
    gpsInfoEl.textContent = `Lat: ${gps.lat.toFixed(6)}, Lng: ${gps.lng.toFixed(6)}`;
    if (window.mapMarker) map.removeLayer(window.mapMarker);
    window.ma
