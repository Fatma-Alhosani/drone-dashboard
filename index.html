<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Drone Dashboard</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
  <style>
    :root{
      --bg:#111; --card:#1e1e1e; --sub:#151515;
      --accent:#4CAF50; --muted:#aaa; --border:#333;
    }
    body.light {
      --bg:#f5f5f5; --card:#fff; --sub:#f0f0f0;
      --accent:#0066cc; --muted:#555; --border:#ccc; color:#000;
    }

    body{
      margin:0;
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background:var(--bg);
      color:#fff;
      transition:background .3s,color .3s;
    }

    header{
      background:#000;
      padding:15px 30px;
      font-size:20px;
      font-weight:bold;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    body.light header{background:#eee;color:#000;}

    .header-status{font-size:14px;color:var(--accent);display:flex;align-items:center;gap:15px;}
    .status-dot{width:10px;height:10px;background:var(--accent);border-radius:50%;}
    .theme-toggle{cursor:pointer;padding:6px 12px;border:1px solid var(--border);border-radius:6px;background:var(--sub);color:inherit;font-size:14px;}

    .wrap{
      padding:32px;
      display:flex;
      justify-content:center;
    }

    /* ðŸŸ¢ Make Violations box fill 70% of the viewport width */
    .violations{
      width:70vw;
      background:var(--card);
      border-radius:14px;
      padding:24px;
      box-shadow:0 0 18px rgba(0,0,0,.35);
      transition:width .3s ease;
    }
    .violations h2{
      margin:0 0 18px 0;
      font-size:26px;
      color:var(--accent);
      padding-bottom:10px;
      border-bottom:1px solid var(--border);
      text-align:left;
    }

    .grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:24px;
    }
    @media (max-width:980px){.grid{grid-template-columns:1fr;} .violations{width:90vw;}}

    .pane{
      background:var(--sub);
      border:1px solid var(--border);
      border-radius:10px;
      padding:16px;
      min-height:520px;
    }
    .pane h3{margin:0 0 10px 0;font-size:15px;text-transform:uppercase;color:#ddd;display:flex;justify-content:space-between;align-items:center;}
    body.light .pane h3{color:#222;}
    .tiny{font-size:12px;color:var(--muted);background:#2b2b2b;padding:4px 8px;border-radius:6px;}
    body.light .tiny{background:#ddd;}

    .feed-container{
      position:relative;width:100%;height:clamp(400px,45vh,640px);
      border-radius:10px;overflow:hidden;background:#101010;
    }
    body.light .feed-container{background:#e0e0e0;}
    .feed-placeholder{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#bbb;}
    #feedImg{width:100%;height:100%;object-fit:contain;border-radius:10px;display:none;}

    #map{height:clamp(320px,40vh,560px);border-radius:10px;margin-top:6px;}
    .coordinates-list{max-height:clamp(160px,22vh,320px);overflow-y:auto;background:#1c1c1c;padding:8px;border-radius:8px;margin-top:10px;font-family:monospace;border:1px solid var(--border);}
    body.light .coordinates-list{background:#fafafa;}
    .coordinates-list div{padding:5px;border-bottom:1px solid #2f2f2f;}
    .coordinates-list div:last-child{border-bottom:none;}
    .active-coordinate{background:#272727;font-weight:bold;}
    body.light .active-coordinate{background:#ddd;}

    .controls{display:flex;align-items:center;justify-content:center;gap:10px;margin:18px 6px;}
    .control-btn{background:#333;color:#fff;border:1px solid #444;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:15px;}
    body.light .control-btn{background:#eee;color:#000;border:1px solid #bbb;}
    .counter{font-size:14px;color:var(--muted);padding:6px 10px;background:#232323;border:1px solid #3a3a3a;border-radius:8px;}
    body.light .counter{background:#f0f0f0;color:#555;border:1px solid #bbb;}

    .meta-row{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap;}
  </style>
</head>
<body>
<header>
  <div>DRONE SURVEILLANCE DASHBOARD</div>
  <div class="header-status">
    <div class="status-dot"></div><span id="connectionStatus">OPERATIONAL</span>
    <button class="theme-toggle" id="themeToggle">ðŸŒ™ Dark</button>
  </div>
</header>

<div class="wrap">
  <section class="violations">
    <h2>Possible Violations</h2>
    <div class="grid">
      <div class="pane">
        <h3>Images <span class="tiny" id="filenameDisplay">Loadingâ€¦</span></h3>
        <div class="feed-container"><div id="feedPlaceholder" class="feed-placeholder">Loadingâ€¦</div><img id="feedImg" alt=""></div>
        <div class="meta-row">
          <span class="tiny">Date: <span id="photoDate">--</span></span>
          <span class="tiny">Time: <span id="photoTime">--</span></span>
        </div>
      </div>
      <div class="pane">
        <h3>GPS Coordinates <span class="tiny">TXT files</span></h3>
        <div style="background:#8b1f1f;padding:10px;border-radius:8px;margin-bottom:8px;">
          <div style="display:flex;justify-content:space-between;font-weight:bold;">
            <span>Current GPS Location</span><span id="currentCoord">--, --</span>
          </div>
          <div style="font-size:12px" id="currentTime">timestamp: --</div>
        </div>
        <div id="map"></div>
        <h4 style="margin:12px 4px 6px">GPS Coordinates</h4>
        <div class="coordinates-list" id="coordinatesList"></div>
      </div>
    </div>
    <div class="controls">
